<?php/** * @Reservation page Template * */global $post, $cs_plugin_options, $cs_plugin_notify;$cs_plugin_notify = new CS_Plugin_Notification_Helper();get_header();if (isset($_SESSION['reserved_vehicles'])) {    unset($_SESSION['reserved_vehicles']);}$params = array();if (( isset($_POST['pickup_location']) && $_POST['pickup_location'] != '' ) && ( isset($_POST['vehicle-type']) && $_POST['vehicle-type'] != '' )) {    $cs_vehicle_type = $_POST['vehicle-type'];    //Date    $date_from = str_replace('.', '-', $_POST['pickup_date']);    $date_to = str_replace('.', '-', $_POST['dropup_date']);    $date_from = date('Y-m-d', strtotime($date_from));    $date_to = date('Y-m-d', strtotime($date_to));    // Time    $pickup_time = date('H:i', strtotime($_POST['pickup_time']));    $dropup_time = date('H:i', strtotime($_POST['dropup_time']));    $params['pickup_location'] = $_POST['pickup_location'];    $params['dropup_location'] = $_POST['dropup_location'];    $params['station'] = $_POST['station'];    $params['vehicle_type'] = $_POST['vehicle-type'];    $params['start_date'] = $date_from;    $params['end_date'] = $date_to;    $params['start_time'] = $pickup_time;    $params['end_time'] = $dropup_time;    $params['booking_id'] = '';    //Set Session    cs_set_session($params);} else {    $session_data = isset($_SESSION['cs_reservation']) ? $_SESSION['cs_reservation'] : '';    $params['vehicle_type'] = isset($session_data['vehicle_type']) && $session_data['vehicle_type'] != '' ? $session_data['vehicle_type'] : '';    $params['pickup_location'] = isset($session_data['pickup_location']) && $session_data['pickup_location'] != '' ? $session_data['pickup_location'] : '';    $params['dropup_location'] = isset($session_data['dropup_location']) && $session_data['dropup_location'] != '' ? $session_data['dropup_location'] : '';    $params['station'] = isset($session_data['station']) && $session_data['station'] != '' ? $session_data['station'] : '';    $params['start_date'] = isset($session_data['start_date']) && !empty($session_data['start_date']) ? $session_data['start_date'] : date('Y-m-d');    $params['end_date'] = isset($session_data['end_date']) && !empty($session_data['end_date']) ? $session_data['end_date'] : date('Y-m-d');    $params['start_time'] = isset($session_data['start_time']) && $session_data['start_time'] != '' ? $session_data['start_time'] : date('H:i A');    $params['end_time'] = isset($session_data['end_time']) && $session_data['end_time'] != '' ? $session_data['end_time'] : date('H:i A');}if (isset($_GET['action']) && $_GET['action'] == 'booking') {    if ($cs_plugin_options['cs_allow_user_booking'] == 'on') {        if (isset($_SESSION['cs_reservation']) && !empty($_SESSION['cs_reservation'])) {            $vehicle_type = $params['vehicle_type'];            $date_from = $params['start_date'];            $date_to = $params['end_date'];            $start_time = $params['start_time'];            $end_time = $params['end_time'];            $station = $params['station'];            $pickup_location = $params['pickup_location'];            $dropup_location = $params['dropup_location'];            $cs_page_id = isset($cs_plugin_options['cs_reservation']) && $cs_plugin_options['cs_reservation'] != '' && absint($cs_plugin_options['cs_reservation']) ? $cs_plugin_options['cs_reservation'] : '';            $search_link = add_query_arg(array('action' => 'booking'), esc_url(get_permalink($cs_page_id)));            $currency_sign = isset($cs_plugin_options['currency_sign']) && $cs_plugin_options['currency_sign'] != '' ? $cs_plugin_options['currency_sign'] : '$';            $cs_payment_vat = isset($cs_plugin_options['cs_payment_vat']) && $cs_plugin_options['cs_payment_vat'] != '' ? $cs_plugin_options['cs_payment_vat'] : '0';            $cs_vat_switch = isset($cs_plugin_options['cs_vat_switch']) && $cs_plugin_options['cs_vat_switch'] == 'on' ? $cs_plugin_options['cs_vat_switch'] : 'off';            $full_pay = isset($cs_plugin_options['cs_allow_full_pay']) && $cs_plugin_options['cs_allow_full_pay'] == 'on' ? $cs_plugin_options['cs_allow_full_pay'] : 'off';            $cs_advance_deposit = isset($cs_plugin_options['cs_advnce_deposit']) && $cs_plugin_options['cs_advnce_deposit'] != '' ? $cs_plugin_options['cs_advnce_deposit'] : '100';            include('vehicle_search.php');        } else {            ?>            <div class="container">                <div class="row">                    <div class="element-size-100">                        <div class="col-md-12">                            <div class="search-back">                                <?php                                if (isset($_POST['vehicle_type']) && $_POST['vehicle_type'] == '') {                                    $cs_plugin_notify->error(__('Oops! please select a vehicle type first.', 'rental'));                                } else {                                    $cs_plugin_notify->error(__('Direct Booking Is not allowed please go back to listing page.', 'rental'));                                }                                ?>                            </div>                        </div>                    </div>                </div>            </div>            <?php        }    } else {        ?>        <div class="container">            <div class="row">                <div class="element-size-100">                    <div class="col-md-12">                        <div class="search-back">                            <?php $cs_plugin_notify->warning(__('Booking is disabled by administrator.', 'rental')); ?>                        </div>                    </div>                </div>            </div>        </div>        <?php    }}get_footer();